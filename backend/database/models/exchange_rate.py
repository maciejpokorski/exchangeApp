from sqlmodel import SQLModel, Field
from sqlalchemy import JSON, Column, event
from typing import Dict
from datetime import date
from sqlalchemy.ext.declarative import declarative_base

class ExchangeRate(SQLModel, table=True):
    """
    Represents exchange rates for a specific date.

    Attributes:
        id (int): The unique identifier for the exchange rate.
        date (date): The date for which the exchange rates are recorded.
        rates (Dict): A dictionary of currency codes and their respective exchange rates.
    """
    id: int = Field(primary_key=True, index=True)
    date: date
    rates: Dict = Field(default={}, sa_column=Column(JSON))

    class Config:
        arbitrary_types_allowed = True

INITIAL_DATA = [
   { 
    'rates': {
        "AED": 3.673023,
        "AFN": 56.151026,
        "ALL": 105.519399,
        "AMD": 412.716,
        "ANG": 1.78906,
        "AOA": 96.481175,
        "ARS": 5.719305,
        "AUD": 1.079813,
        "AWG": 1.789975,
        "AZN": 0.7843,
        "BAM": 1.472028,
        "BBD": 2,
        "BDT": 77.63892,
        "BGN": 1.472405,
        "BHD": 0.377005,
        "BIF": 1540.318433,
        "BMD": 1,
        "BND": 1.267353,
        "BOB": 6.908185,
        "BRL": 2.277267,
        "BSD": 1,
        "BTC": 0.00717786,
        "BTN": 63.60345,
        "BWP": 8.536126,
        "BYR": 9060.65,
        "BZD": 1.981486,
        "CAD": 1.032803,
        "CDF": 926.283333,
        "CHF": 0.931198,
        "CLF": 0.02176,
        "CLP": 502.074771,
        "CNY": 6.124622,
        "COP": 1924.058962,
        "CRC": 503.875816,
        "CUP": 22.682881,
        "CVE": 82.30849,
        "CZK": 19.412245,
        "DJF": 177.918999,
        "DKK": 5.610268,
        "DOP": 42.567972,
        "DZD": 82.054016,
        "EEK": 11.761137,
        "EGP": 6.895493,
        "ETB": 18.87842,
        "EUR": 0.752091,
        "FJD": 1.864912,
        "FKP": 0.632807,
        "GBP": 0.632807,
        "GEL": 1.65995,
        "GHS": 2.176896,
        "GIP": 0.632807,
        "GMD": 32.58944,
        "GNF": 6921.140267,
        "GTQ": 7.934295,
        "GYD": 202.124999,
        "HKD": 7.754194,
        "HNL": 20.385459,
        "HRK": 5.707007,
        "HTG": 43.27088,
        "HUF": 226.215743,
        "IDR": 11346.9841,
        "ILS": 3.556682,
        "INR": 63.573054,
        "IQD": 1163.378333,
        "IRR": 24848.584367,
        "ISK": 121.059999,
        "JEP": 0.632807,
        "JMD": 101.743112,
        "JOD": 0.708727,
        "JPY": 99.637483,
        "KES": 87.588465,
        "KGS": 49.296851,
        "KHR": 4073.7685,
        "KMF": 371.282361,
        "KPW": 900,
        "KRW": 1085.098417,
        "KWD": 0.284574,
        "KYD": 0.82102,
        "KZT": 153.365627,
        "LAK": 7852.023333,
        "LBP": 1511.732325,
        "LKR": 132.359107,
        "LRD": 78.359151,
        "LSL": 9.949758,
        "LTL": 2.597152,
        "LVL": 0.528496,
        "LYD": 1.267944,
        "MAD": 8.402665,
        "MDL": 12.817782,
        "MGA": 2214.533333,
        "MKD": 46.252206,
        "MMK": 969.98722,
        "MNT": 1697.166667,
        "MOP": 7.984632,
        "MRO": 294.8197,
        "MTL": 0.683602,
        "MUR": 30.942665,
        "MVR": 15.362,
        "MWK": 331.1108,
        "MXN": 13.07607,
        "MYR": 3.275788,
        "MZN": 29.870325,
        "NAD": 9.942922,
        "NGN": 163.19466,
        "NIO": 24.577374,
        "NOK": 5.895271,
        "NPR": 101.842484,
        "NZD": 1.228997,
        "OMR": 0.385001,
        "PAB": 1,
        "PEN": 2.778046,
        "PGK": 2.426183,
        "PHP": 43.776559,
        "PKR": 104.587892,
        "PLN": 3.176398,
        "PYG": 4467.301125,
        "QAR": 3.640304,
        "RON": 3.369428,
        "RSD": 86.543005,
        "RUB": 32.710187,
        "RWF": 655.48478,
        "SAR": 3.750443,
        "SBD": 7.146293,
        "SCR": 12.044694,
        "SDG": 4.406807,
        "SEK": 6.523661,
        "SGD": 1.267686,
        "SHP": 0.632807,
        "SLL": 4312.586333,
        "SOS": 1279.145767,
        "SRD": 3.2875,
        "STD": 18458.167333,
        "SVC": 8.745461,
        "SYP": 129.293624,
        "SZL": 9.952398,
        "THB": 31.757554,
        "TJS": 4.767725,
        "TMT": 2.853333,
        "TND": 1.651744,
        "TOP": 1.852532,
        "TRY": 2.025848,
        "TTD": 6.411863,
        "TWD": 29.692417,
        "TZS": 1614.197223,
        "UAH": 8.162982,
        "UGX": 2572.689773,
        "USD": 1,
        "UYU": 22.347911,
        "UZS": 2127.645555,
        "VEF": 6.290344,
        "VND": 21146.648925,
        "VUV": 96.739999,
        "WST": 2.352262,
        "XAF": 493.836311,
        "XAG": 0.04460763,
        "XAU": 0.00075505,
        "XCD": 2.70156,
        "XDR": 0.658033,
        "XOF": 493.833399,
        "XPF": 89.710821,
        "YER": 214.960018,
        "ZAR": 9.957742,
        "ZMK": 5230.441665,
        "ZMW": 5.352488,
        "ZWL": 322.355006
        },
        'date': date(2023,9,12), 
   },
   {
       'rates': 
       {
        "AED": 3.673058,
        "AFN": 56.117425,
        "ALL": 105.442401,
        "AMD": 412.428001,
        "ANG": 1.789,
        "AOA": 96.828775,
        "ARS": 5.716519,
        "AUD": 1.072607,
        "AWG": 1.789975,
        "AZN": 0.7843,
        "BAM": 1.471611,
        "BBD": 2,
        "BDT": 77.479369,
        "BGN": 1.472711,
        "BHD": 0.377016,
        "BIF": 1538.531767,
        "BMD": 1,
        "BND": 1.265218,
        "BOB": 6.892125,
        "BRL": 2.277723,
        "BSD": 1,
        "BTC": 0.00746635,
        "BTN": 63.485863,
        "BWP": 8.535566,
        "BYR": 9053.94,
        "BZD": 1.986069,
        "CAD": 1.032744,
        "CDF": 925.05,
        "CHF": 0.931779,
        "CLF": 0.02179,
        "CLP": 503.619482,
        "CNY": 6.125561,
        "COP": 1928.558619,
        "CRC": 505.039983,
        "CUP": 22.682881,
        "CVE": 82.2909,
        "CZK": 19.383077,
        "DJF": 177.751999,
        "DKK": 5.610043,
        "DOP": 42.530115,
        "DZD": 82.097408,
        "EEK": 11.759297,
        "EGP": 6.896406,
        "ETB": 18.82462,
        "EUR": 0.751733,
        "FJD": 1.85992,
        "FKP": 0.632319,
        "GBP": 0.632319,
        "GEL": 1.660617,
        "GHS": 2.171408,
        "GIP": 0.632319,
        "GMD": 32.4949,
        "GNF": 6903.511967,
        "GTQ": 7.934037,
        "GYD": 201.851666,
        "HKD": 7.754439,
        "HNL": 20.351376,
        "HRK": 5.707535,
        "HTG": 43.21626,
        "HUF": 225.396077,
        "IDR": 11318.6716,
        "ILS": 3.566664,
        "INR": 63.37631,
        "IQD": 1162.683383,
        "IRR": 24799.484367,
        "ISK": 120.944,
        "JEP": 0.632319,
        "JMD": 101.491039,
        "JOD": 0.708904,
        "JPY": 100.003339,
        "KES": 87.564676,
        "KGS": 49.21015,
        "KHR": 4069.9035,
        "KMF": 371.143431,
        "KPW": 900,
        "KRW": 1085.611589,
        "KWD": 0.284848,
        "KYD": 0.820323,
        "KZT": 153.284639,
        "LAK": 7847.23,
        "LBP": 1510.161005,
        "LKR": 132.465915,
        "LRD": 78.400001,
        "LSL": 9.902721,
        "LTL": 2.596786,
        "LVL": 0.528408,
        "LYD": 1.267986,
        "MAD": 8.398292,
        "MDL": 12.814468,
        "MGA": 2208.156667,
        "MKD": 46.36814,
        "MMK": 966.91512,
        "MNT": 1695,
        "MOP": 7.969096,
        "MRO": 294.2296,
        "MTL": 0.683738,
        "MUR": 30.99599,
        "MVR": 15.374,
        "MWK": 327.2872,
        "MXN": 13.05874,
        "MYR": 3.264538,
        "MZN": 29.863625,
        "NAD": 9.911802,
        "NGN": 162.997088,
        "NIO": 24.51745,
        "NOK": 5.925673,
        "NPR": 101.689168,
        "NZD": 1.232139,
        "OMR": 0.385022,
        "PAB": 1,
        "PEN": 2.787539,
        "PGK": 2.4319,
        "PHP": 43.723769,
        "PKR": 104.446991,
        "PLN": 3.178489,
        "PYG": 4462.821428,
        "QAR": 3.638303,
        "RON": 3.368414,
        "RSD": 86.440159,
        "RUB": 32.833336,
        "RWF": 655.11932,
        "SAR": 3.750518,
        "SBD": 7.170598,
        "SCR": 12.022902,
        "SDG": 4.397947,
        "SEK": 6.530709,
        "SGD": 1.266435,
        "SHP": 0.632319,
        "SLL": 4329.536283,
        "SOS": 1281.424467,
        "SRD": 3.2875,
        "STD": 18461.367333,
        "SVC": 8.725194,
        "SYP": 128.787124,
        "SZL": 9.912581,
        "THB": 31.966624,
        "TJS": 4.7673,
        "TMT": 2.853333,
        "TND": 1.650003,
        "TOP": 1.857123,
        "TRY": 2.013888,
        "TTD": 6.398986,
        "TWD": 29.653016,
        "TZS": 1613.635808,
        "UAH": 8.150674,
        "UGX": 2574.266023,
        "USD": 1,
        "UYU": 22.313195,
        "UZS": 2127.645555,
        "VEF": 6.290384,
        "VND": 21152.561425,
        "VUV": 96.0425,
        "WST": 2.338708,
        "XAF": 493.527952,
        "XAG": 0.04311055,
        "XAU": 0.00072521,
        "XCD": 2.70152,
        "XDR": 0.658727,
        "XOF": 493.81462,
        "XPF": 89.703819,
        "YER": 214.973351,
        "ZAR": 9.903925,
        "ZMK": 5230.441665,
        "ZMW": 5.342413,
        "ZWL": 322.355006
       },
       'date': date(2023, 9, 11)
   },
   {
       'rates': {
            "AED": 3.673073,
            "AFN": 56.152525,
            "ALL": 105.7959,
            "AMD": 414.030997,
            "ANG": 1.78896,
            "AOA": 96.71635,
            "ARS": 5.708338,
            "AUD": 1.075754,
            "AWG": 1.789975,
            "AZN": 0.784267,
            "BAM": 1.476878,
            "BBD": 2,
            "BDT": 77.536869,
            "BGN": 1.476872,
            "BHD": 0.377064,
            "BIF": 1539.5951,
            "BMD": 1,
            "BND": 1.269047,
            "BOB": 6.903191,
            "BRL": 2.286783,
            "BSD": 1,
            "BTC": 0.00758311,
            "BTN": 64.128725,
            "BWP": 8.588761,
            "BYR": 9040.25,
            "BZD": 1.985776,
            "CAD": 1.036137,
            "CDF": 925.876667,
            "CHF": 0.934976,
            "CLF": 0.02191,
            "CLP": 506.351981,
            "CNY": 6.127332,
            "COP": 1940.446323,
            "CRC": 508.315087,
            "CUP": 22.682881,
            "CVE": 82.584629,
            "CZK": 19.48053,
            "DJF": 177.469999,
            "DKK": 5.627774,
            "DOP": 42.591189,
            "DZD": 82.156114,
            "EEK": 11.767077,
            "EGP": 6.897752,
            "ETB": 18.85398,
            "EUR": 0.753959,
            "FJD": 1.862232,
            "FKP": 0.636038,
            "GBP": 0.636038,
            "GEL": 1.660833,
            "GHS": 2.173473,
            "GIP": 0.636038,
            "GMD": 32.53972,
            "GNF": 6928.482033,
            "GTQ": 7.955116,
            "GYD": 202.696249,
            "HKD": 7.75476,
            "HNL": 20.369751,
            "HRK": 5.725435,
            "HTG": 43.28536,
            "HUF": 226.102312,
            "IDR": 11205.683333,
            "ILS": 3.592884,
            "INR": 63.994336,
            "IQD": 1162.838359,
            "IRR": 24819.151033,
            "ISK": 120.993001,
            "JEP": 0.636038,
            "JMD": 101.554439,
            "JOD": 0.707558,
            "JPY": 100.178755,
            "KES": 87.54114,
            "KGS": 49.0955,
            "KHR": 4073.4935,
            "KMF": 371.64546,
            "KPW": 900,
            "KRW": 1086.054687,
            "KWD": 0.285078,
            "KYD": 0.820386,
            "KZT": 153.360252,
            "LAK": 7848.49,
            "LBP": 1510.251005,
            "LKR": 132.880756,
            "LRD": 78.990734,
            "LSL": 10.006085,
            "LTL": 2.604574,
            "LVL": 0.530002,
            "LYD": 1.271993,
            "MAD": 8.41669,
            "MDL": 12.824885,
            "MGA": 2201.151667,
            "MKD": 46.553911,
            "MMK": 968.19432,
            "MNT": 1692.666667,
            "MOP": 7.977849,
            "MRO": 294.5589,
            "MTL": 0.683602,
            "MUR": 31.032502,
            "MVR": 15.384,
            "MWK": 330.1622,
            "MXN": 13.096106,
            "MYR": 3.282146,
            "MZN": 29.825175,
            "NAD": 10.00229,
            "NGN": 163.202522,
            "NIO": 24.550525,
            "NOK": 5.96045,
            "NPR": 102.953978,
            "NZD": 1.24181,
            "OMR": 0.385017,
            "PAB": 1,
            "PEN": 2.797199,
            "PGK": 2.443617,
            "PHP": 43.827797,
            "PKR": 104.57152,
            "PLN": 3.210758,
            "PYG": 4469.928928,
            "QAR": 3.639876,
            "RON": 3.36925,
            "RSD": 86.866687,
            "RUB": 33.025457,
            "RWF": 655.31682,
            "SAR": 3.750659,
            "SBD": 7.166814,
            "SCR": 12.025994,
            "SDG": 4.398863,
            "SEK": 6.558003,
            "SGD": 1.269449,
            "SHP": 0.636038,
            "SLL": 4312.586333,
            "SOS": 1283.6046,
            "SRD": 3.283333,
            "STD": 18527.300667,
            "SVC": 8.737181,
            "SYP": 128.625749,
            "SZL": 10.008225,
            "THB": 32.140568,
            "TJS": 4.767175,
            "TMT": 2.853333,
            "TND": 1.650422,
            "TOP": 1.85719,
            "TRY": 2.021988,
            "TTD": 6.40539,
            "TWD": 29.662593,
            "TZS": 1615.788245,
            "UAH": 8.160925,
            "UGX": 2575.047398,
            "USD": 1,
            "UYU": 22.404243,
            "UZS": 2127.645555,
            "VEF": 6.291244,
            "VND": 21146.648925,
            "VUV": 96.645001,
            "WST": 2.345335,
            "XAF": 495.404589,
            "XAG": 0.04332294,
            "XAU": 0.00072523,
            "XCD": 2.70154,
            "XDR": 0.659709,
            "XOF": 495.455421,
            "XPF": 90.02946,
            "YER": 215.003351,
            "ZAR": 9.992023,
            "ZMK": 5230.441665,
            "ZMW": 5.350202,
            "ZWL": 322.355006
       },
       'date': date(2023, 9, 10)
   }
]

def seed_exchange_rate(target, connection, **kw):
    connection.execute(target.insert(), INITIAL_DATA)

event.listen(ExchangeRate.__table__, 'after_create', seed_exchange_rate)